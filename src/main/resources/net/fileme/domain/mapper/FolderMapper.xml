<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.fileme.domain.mapper.FolderMapper">

    <select id="getSuperFolders">
        with recursive cte as(
        select folder_id, user_id, folder_name, parent_id, 0 as sort from folder where folder_id = #{folder_id}
        union
        select f.folder_id, f.user_id, f.folder_name, f.parent_id, sort + 1
        from folder f
        join cte on cte.parent_id = f.folder_id
        )
        select * from cte order by sort
    </select>

</mapper>